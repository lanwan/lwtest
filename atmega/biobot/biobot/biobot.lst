   1               		.file	"biobot.c"
   2               	__SREG__ = 0x3f
   3               	__SP_H__ = 0x3e
   4               	__SP_L__ = 0x3d
   5               	__CCP__  = 0x34
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   9               		.text
  10               	.Ltext0:
  93               		.lcomm gServoIndex,1
  94               		.data
  97               	gActiveServoIndex0:
  98 0000 FF        		.byte	-1
 101               	gActiveServoIndex1:
 102 0001 FF        		.byte	-1
 105               	gServoPins:
 106 0002 05        		.byte	5
 107 0003 04        		.byte	4
 108 0004 03        		.byte	3
 109 0005 02        		.byte	2
 110 0006 01        		.byte	1
 111 0007 00        		.byte	0
 112 0008 05        		.byte	5
 113 0009 04        		.byte	4
 114 000a 03        		.byte	3
 115 000b 02        		.byte	2
 116 000c 01        		.byte	1
 117 000d 00        		.byte	0
 118 000e 07        		.byte	7
 119 000f 06        		.byte	6
 120 0010 05        		.byte	5
 121 0011 04        		.byte	4
 124               	gServoPorts:
 125 0012 3500      		.word	53
 126 0014 3500      		.word	53
 127 0016 3500      		.word	53
 128 0018 3500      		.word	53
 129 001a 3500      		.word	53
 130 001c 3500      		.word	53
 131 001e 3800      		.word	56
 132 0020 3800      		.word	56
 133 0022 3800      		.word	56
 134 0024 3800      		.word	56
 135 0026 3800      		.word	56
 136 0028 3800      		.word	56
 137 002a 3200      		.word	50
 138 002c 3200      		.word	50
 139 002e 3200      		.word	50
 140 0030 3200      		.word	50
 141               	.global	gfile_shell
 142               	.global	gfile_shell
 143               		.section .bss
 146               	gfile_shell:
 147 0000 0000      		.skip 2,0
 148               		.text
 150               	.global	__vector_8
 152               	__vector_8:
   1:biobot.c      **** /*
   2:biobot.c      ****  * biobot.c
   3:biobot.c      ****  *
   4:biobot.c      ****  * Created: 2012/6/20 14:35:21
   5:biobot.c      ****  * Author: steven.zdwang@gmail.com
   6:biobot.c      ****  * Copyright (C) Lanwan electronic Inc.
   7:biobot.c      ****  */
   8:biobot.c      **** 
   9:biobot.c      **** #include "biobot_config.h"
  10:biobot.c      **** #include <avr/io.h>
  11:biobot.c      **** #include "pt.h"
  12:biobot.c      **** 
  13:biobot.c      **** #define F_CPU 800000000
  14:biobot.c      **** 
  15:biobot.c      **** #define SERVO_PIN0  PC5
  16:biobot.c      **** #define SERVO_PIN1  PC4
  17:biobot.c      **** #define SERVO_PIN2  PC3
  18:biobot.c      **** #define SERVO_PIN3  PC2
  19:biobot.c      **** #define SERVO_PIN4  PC1
  20:biobot.c      **** #define SERVO_PIN5  PC0
  21:biobot.c      **** 
  22:biobot.c      **** #define SERVO_PIN6  PB5
  23:biobot.c      **** #define SERVO_PIN7  PB4
  24:biobot.c      **** #define SERVO_PIN8  PB3
  25:biobot.c      **** #define SERVO_PIN9  PB2
  26:biobot.c      **** #define SERVO_PIN10  PB1
  27:biobot.c      **** #define SERVO_PIN11  PB0
  28:biobot.c      **** 
  29:biobot.c      **** #define SERVO_PIN12  PD7
  30:biobot.c      **** #define SERVO_PIN13  PD6
  31:biobot.c      **** #define SERVO_PIN14  PD5
  32:biobot.c      **** #define SERVO_PIN15  PD4
  33:biobot.c      **** 
  34:biobot.c      **** #define SERVO_PORT0     ((uint8_t*) 0x35)
  35:biobot.c      **** #define SERVO_PORT1     ((uint8_t*) 0x35)
  36:biobot.c      **** #define SERVO_PORT2     ((uint8_t*) 0x35)
  37:biobot.c      **** #define SERVO_PORT3     ((uint8_t*) 0x35)
  38:biobot.c      **** #define SERVO_PORT4     ((uint8_t*) 0x35)
  39:biobot.c      **** #define SERVO_PORT5     ((uint8_t*) 0x35)
  40:biobot.c      **** 
  41:biobot.c      **** #define SERVO_PORT6     ((uint8_t*) 0x38)
  42:biobot.c      **** #define SERVO_PORT7     ((uint8_t*) 0x38)
  43:biobot.c      **** #define SERVO_PORT8     ((uint8_t*) 0x38)
  44:biobot.c      **** #define SERVO_PORT9     ((uint8_t*) 0x38)
  45:biobot.c      **** #define SERVO_PORT10    ((uint8_t*) 0x38)
  46:biobot.c      **** #define SERVO_PORT11    ((uint8_t*) 0x38)
  47:biobot.c      **** 
  48:biobot.c      **** #define SERVO_PORT12    ((uint8_t*) 0x32)
  49:biobot.c      **** #define SERVO_PORT13    ((uint8_t*) 0x32)
  50:biobot.c      **** #define SERVO_PORT14    ((uint8_t*) 0x32)
  51:biobot.c      **** #define SERVO_PORT15    ((uint8_t*) 0x32)
  52:biobot.c      **** 
  53:biobot.c      **** 
  54:biobot.c      **** 
  55:biobot.c      **** struct servo_t{	
  56:biobot.c      ****     uint8_t enabled;
  57:biobot.c      ****     uint8_t speed;	
  58:biobot.c      **** 	
  59:biobot.c      ****     uint16_t start_pulse;
  60:biobot.c      ****     uint16_t end_pulse;
  61:biobot.c      **** 	
  62:biobot.c      ****     uint16_t current_pulse;	
  63:biobot.c      **** 	
  64:biobot.c      ****     uint16_t pulse_slot_rtct;
  65:biobot.c      ****     uint16_t pulse_slot_count;
  66:biobot.c      ****     uint16_t pulse_slot_header;
  67:biobot.c      ****     uint8_t pulse_slot;
  68:biobot.c      **** };
  69:biobot.c      **** 
  70:biobot.c      **** 
  71:biobot.c      **** #define PIN_COUNT                   16                              // 16 servo pin
  72:biobot.c      **** #define PULSE_SLOT_CODE_TIME        27                              // us
  73:biobot.c      **** #define PULSE_SLOT_TIME             100      // us
  74:biobot.c      **** #define PULSE_SLOT_RELOAD_COUNT     (0xFF - PULSE_SLOT_TIME - PULSE_SLOT_CODE_TIME)     // us
  75:biobot.c      **** 
  76:biobot.c      **** #define MAIN_PULSE_PERIOD           20000                           // us
  77:biobot.c      **** #define MAIN_PULSE_SLOT_CODE_TIME   0                               // us
  78:biobot.c      **** #define MAIN_PULSE_SLOT_TIME        MAIN_PULSE_PERIOD/PIN_COUNT    // us
  79:biobot.c      **** #define MAIN_SLOT_COUNT             (MAIN_PULSE_PERIOD / MAIN_PULSE_SLOT_TIME / PIN_COUNT)
  80:biobot.c      **** #define MAIN_SLOT_RELOAD_COUNTER    (0xFFFF-1150)   // :=13000us, 1250us
  81:biobot.c      **** 
  82:biobot.c      **** static uint8_t volatile gServoIndex = 0;		
  83:biobot.c      **** static int8_t volatile gActiveServoIndex0 = -1;
  84:biobot.c      **** static int8_t volatile gActiveServoIndex1 = -1; 								
  85:biobot.c      **** 
  86:biobot.c      **** struct servo_t gServos[PIN_COUNT];
  87:biobot.c      **** 
  88:biobot.c      **** static uint8_t gServoPins[PIN_COUNT] = {
  89:biobot.c      ****                                         SERVO_PIN0, SERVO_PIN1, SERVO_PIN2, SERVO_PIN3,
  90:biobot.c      ****                                         SERVO_PIN4, SERVO_PIN5, SERVO_PIN6, SERVO_PIN7,
  91:biobot.c      ****                                         SERVO_PIN8, SERVO_PIN9, SERVO_PIN10, SERVO_PIN11,
  92:biobot.c      ****                                         SERVO_PIN12, SERVO_PIN13, SERVO_PIN14, SERVO_PIN15
  93:biobot.c      ****                                         };
  94:biobot.c      **** 
  95:biobot.c      **** static uint8_t* gServoPorts[PIN_COUNT]={
  96:biobot.c      ****                                         SERVO_PORT0, SERVO_PORT1, SERVO_PORT2, SERVO_PORT3,
  97:biobot.c      ****                                         SERVO_PORT4, SERVO_PORT5, SERVO_PORT6, SERVO_PORT7,
  98:biobot.c      ****                                         SERVO_PORT8, SERVO_PORT9, SERVO_PORT10, SERVO_PORT11,
  99:biobot.c      ****                                         SERVO_PORT12, SERVO_PORT13, SERVO_PORT14, SERVO_PORT15
 100:biobot.c      ****                                         };
 101:biobot.c      **** 
 102:biobot.c      **** FILE* gfile_shell = NULL;
 103:biobot.c      **** 
 104:biobot.c      **** 
 105:biobot.c      **** #define DEBUG_PULSE_HIGH()    (PORTD |= _BV(PD0))
 106:biobot.c      **** #define DEBUG_PULSE_LOW()     (PORTD &= ~_BV(PD0))
 107:biobot.c      **** #define DEBUG_PULSE_HIGH_1()    (PORTD |= _BV(PD1))
 108:biobot.c      **** #define DEBUG_PULSE_LOW_1()     (PORTD &= ~_BV(PD1))
 109:biobot.c      **** 
 110:biobot.c      **** /**
 111:biobot.c      ****  * TIMER1(16bit)
 112:biobot.c      ****  */
 113:biobot.c      **** ISR( TIMER1_OVF_vect )
 114:biobot.c      **** {	    			
 153               	
 154               		push r0
 155               		in r0,__SREG__
 156 0000 1F92      		push r0
 157 0002 0F92      		clr __zero_reg__
 158 0004 0FB6      		push r16
 159 0006 0F92      		push r17
 160 0008 1124      		push r18
 161 000a 0F93      		push r19
 162 000c 1F93      		push r20
 163 000e 2F93      		push r21
 164 0010 3F93      		push r22
 165 0012 4F93      		push r23
 166 0014 5F93      		push r24
 167 0016 6F93      		push r25
 168 0018 7F93      		push r26
 169 001a 8F93      		push r27
 170 001c 9F93      		push r30
 171 001e AF93      		push r31
 172 0020 BF93      		push r29
 173 0022 EF93      		push r28
 174 0024 FF93      		in r28,__SP_L__
 175 0026 DF93      		in r29,__SP_H__
 176 0028 CF93      	/* prologue: Signal */
 177 002a CDB7      	/* frame size = 0 */
 179               	.LM1:
 180               		ldi r26,lo8(50)
 115:biobot.c      ****     DEBUG_PULSE_HIGH();
 181               	o8(50)
 182               		ldi r31,hi8(50)
 183 002e A2E3      		ld r24,Z
 184 0030 B0E0      		ori r24,lo8(1)
 185 0032 E2E3      		st X,r24
 187 0036 8081      	.LM2:
 188 0038 8160      		lds r24,gServoIndex
 189 003a 8C93      		mov r18,r24
 116:biobot.c      **** 
 117:biobot.c      ****     if( gServos[gServoIndex].enabled == 0 ) goto inc_index;
 190               	lo8(0)
 191               		movw r24,r18
 192 003c 8091 0000 		lsl r24
 193 0040 282F      		rol r25
 194 0042 30E0      		add r24,r18
 195 0044 C901      		adc r25,r19
 196 0046 880F      		movw r18,r24
 197 0048 991F      		lsl r18
 198 004a 820F      		rol r19
 199 004c 931F      		lsl r18
 200 004e 9C01      		rol r19
 201 0050 220F      		add r24,r18
 202 0052 331F      		adc r25,r19
 203 0054 220F      		movw r30,r24
 204 0056 331F      		subi r30,lo8(-(gServos))
 205 0058 820F      		sbci r31,hi8(-(gServos))
 206 005a 931F      		ld r24,Z
 207 005c FC01      		tst r24
 208 005e E050      		brne .+2
 209 0060 F040      		rjmp .L2
 211 0064 8823      	.LM3:
 212 0066 01F4      		lds r24,gServoIndex
 213 0068 00C0      		mov r20,r24
 118:biobot.c      **** 		
 119:biobot.c      ****     // set current high pulse width
 120:biobot.c      ****     gServos[gServoIndex].current_pulse = gServos[gServoIndex].end_pulse;
 214               	,gServoIndex
 215               		mov r18,r24
 216 006a 8091 0000 		ldi r19,lo8(0)
 217 006e 482F      		movw r24,r18
 218 0070 50E0      		lsl r24
 219 0072 8091 0000 		rol r25
 220 0076 282F      		add r24,r18
 221 0078 30E0      		adc r25,r19
 222 007a C901      		movw r18,r24
 223 007c 880F      		lsl r18
 224 007e 991F      		rol r19
 225 0080 820F      		lsl r18
 226 0082 931F      		rol r19
 227 0084 9C01      		add r24,r18
 228 0086 220F      		adc r25,r19
 229 0088 331F      		movw r30,r24
 230 008a 220F      		subi r30,lo8(-(gServos+4))
 231 008c 331F      		sbci r31,hi8(-(gServos+4))
 232 008e 820F      		ld r22,Z
 233 0090 931F      		ldd r23,Z+1
 234 0092 FC01      		movw r24,r20
 235 0094 E050      		lsl r24
 236 0096 F040      		rol r25
 237 0098 6081      		add r24,r20
 238 009a 7181      		adc r25,r21
 239 009c CA01      		movw r18,r24
 240 009e 880F      		lsl r18
 241 00a0 991F      		rol r19
 242 00a2 840F      		lsl r18
 243 00a4 951F      		rol r19
 244 00a6 9C01      		add r24,r18
 245 00a8 220F      		adc r25,r19
 246 00aa 331F      		movw r30,r24
 247 00ac 220F      		subi r30,lo8(-(gServos+6))
 248 00ae 331F      		sbci r31,hi8(-(gServos+6))
 249 00b0 820F      		std Z+1,r23
 250 00b2 931F      		st Z,r22
 252 00b6 E050      	.LM4:
 253 00b8 F040      		lds r24,gActiveServoIndex0
 254 00ba 7183      		cpi r24,lo8(-1)
 255 00bc 6083      		breq .+2
 121:biobot.c      **** 	
 122:biobot.c      ****     //set timer1 or timer2
 123:biobot.c      ****     if( gActiveServoIndex0 == -1 )
 256               	5:
 257               		lds r24,gServoIndex
 258 00be 8091 0000 		sts gActiveServoIndex0,r24
 260 00c4 01F0      	.LM6:
 261 00c6 00C0      		lds r24,gServoIndex
 124:biobot.c      ****     {	
 125:biobot.c      ****         gActiveServoIndex0 = gServoIndex;                              		                          
 262               	16,r24
 263               		ldi r17,lo8(0)
 264 00c8 8091 0000 		lds r24,gServoIndex
 265 00cc 8093 0000 		mov r18,r24
 126:biobot.c      ****         gServos[gServoIndex].pulse_slot_header = gServos[gServoIndex].current_pulse % PULSE_SLOT_TI
 266               	 r19,lo8(0)
 267               		movw r24,r18
 268 00d0 8091 0000 		lsl r24
 269 00d4 082F      		rol r25
 270 00d6 10E0      		add r24,r18
 271 00d8 8091 0000 		adc r25,r19
 272 00dc 282F      		movw r18,r24
 273 00de 30E0      		lsl r18
 274 00e0 C901      		rol r19
 275 00e2 880F      		lsl r18
 276 00e4 991F      		rol r19
 277 00e6 820F      		add r24,r18
 278 00e8 931F      		adc r25,r19
 279 00ea 9C01      		movw r30,r24
 280 00ec 220F      		subi r30,lo8(-(gServos+6))
 281 00ee 331F      		sbci r31,hi8(-(gServos+6))
 282 00f0 220F      		ld r24,Z
 283 00f2 331F      		ldd r25,Z+1
 284 00f4 820F      		ldi r18,lo8(100)
 285 00f6 931F      		ldi r19,hi8(100)
 286 00f8 FC01      		movw r22,r18
 287 00fa E050      		rcall __udivmodhi4
 288 00fc F040      		movw r20,r24
 289 00fe 8081      		subi r20,lo8(-(100))
 290 0100 9181      		sbci r21,hi8(-(100))
 291 0102 24E6      		movw r24,r16
 292 0104 30E0      		lsl r24
 293 0106 B901      		rol r25
 294 0108 00D0      		add r24,r16
 295 010a AC01      		adc r25,r17
 296 010c 4C59      		movw r18,r24
 297 010e 5F4F      		lsl r18
 298 0110 C801      		rol r19
 299 0112 880F      		lsl r18
 300 0114 991F      		rol r19
 301 0116 800F      		add r24,r18
 302 0118 911F      		adc r25,r19
 303 011a 9C01      		movw r30,r24
 304 011c 220F      		subi r30,lo8(-(gServos+12))
 305 011e 331F      		sbci r31,hi8(-(gServos+12))
 306 0120 220F      		std Z+1,r21
 307 0122 331F      		st Z,r20
 309 0126 931F      	.LM7:
 310 0128 FC01      		lds r24,gServoIndex
 311 012a E050      		mov r16,r24
 312 012c F040      		ldi r17,lo8(0)
 313 012e 5183      		lds r24,gServoIndex
 314 0130 4083      		mov r18,r24
 127:biobot.c      ****         gServos[gServoIndex].pulse_slot_count = gServos[gServoIndex].current_pulse / PULSE_SLOT_TIM
 315               	add r24,r18
 316               		adc r25,r19
 317 0132 8091 0000 		movw r18,r24
 318 0136 082F      		lsl r18
 319 0138 10E0      		rol r19
 320 013a 8091 0000 		lsl r18
 321 013e 282F      		rol r19
 322 0140 30E0      		add r24,r18
 323 0142 C901      		adc r25,r19
 324 0144 880F      		movw r30,r24
 325 0146 991F      		subi r30,lo8(-(gServos+6))
 326 0148 820F      		sbci r31,hi8(-(gServos+6))
 327 014a 931F      		ld r24,Z
 328 014c 9C01      		ldd r25,Z+1
 329 014e 220F      		ldi r18,lo8(100)
 330 0150 331F      		ldi r19,hi8(100)
 331 0152 220F      		movw r22,r18
 332 0154 331F      		rcall __udivmodhi4
 333 0156 820F      		movw r24,r22
 334 0158 931F      		movw r20,r24
 335 015a FC01      		subi r20,lo8(-(-1))
 336 015c E050      		sbci r21,hi8(-(-1))
 337 015e F040      		movw r24,r16
 338 0160 8081      		lsl r24
 339 0162 9181      		rol r25
 340 0164 24E6      		add r24,r16
 341 0166 30E0      		adc r25,r17
 342 0168 B901      		movw r18,r24
 343 016a 00D0      		lsl r18
 344 016c CB01      		rol r19
 345 016e AC01      		lsl r18
 346 0170 4150      		rol r19
 347 0172 5040      		add r24,r18
 348 0174 C801      		adc r25,r19
 349 0176 880F      		movw r30,r24
 350 0178 991F      		subi r30,lo8(-(gServos+10))
 351 017a 800F      		sbci r31,hi8(-(gServos+10))
 352 017c 911F      		std Z+1,r21
 353 017e 9C01      		st Z,r20
 355 0182 331F      	.LM8:
 356 0184 220F      		ldi r26,lo8(50)
 357 0186 331F      		ldi r27,hi8(50)
 358 0188 820F      		ldi r30,lo8(50)
 359 018a 931F      		ldi r31,hi8(50)
 360 018c FC01      		ld r24,Z
 361 018e E050      		ori r24,lo8(2)
 362 0190 F040      		st X,r24
 364 0194 4083      	.LM9:
 128:biobot.c      **** 
 129:biobot.c      ****         // set high pulse
 130:biobot.c      ****         DEBUG_PULSE_HIGH_1();
 365               		lsl r24
 366               		rol r25
 367 0196 A2E3      		movw r30,r24
 368 0198 B0E0      		subi r30,lo8(-(gServoPorts))
 369 019a E2E3      		sbci r31,hi8(-(gServoPorts))
 370 019c F0E0      		ld r26,Z
 371 019e 8081      		ldd r27,Z+1
 372 01a0 8260      		ld r24,X
 373 01a2 8C93      		mov r20,r24
 131:biobot.c      ****         *(gServoPorts[gServoIndex]) |= _BV(gServoPins[gServoIndex]);
 374               	gServoIndex
 375               		mov r24,r24
 376 01a4 8091 0000 		ldi r25,lo8(0)
 377 01a8 882F      		movw r30,r24
 378 01aa 90E0      		subi r30,lo8(-(gServoPins))
 379 01ac 880F      		sbci r31,hi8(-(gServoPins))
 380 01ae 991F      		ld r24,Z
 381 01b0 FC01      		mov r18,r24
 382 01b2 E050      		ldi r19,lo8(0)
 383 01b4 F040      		ldi r24,lo8(1)
 384 01b6 A081      		ldi r25,hi8(1)
 385 01b8 B181      		rjmp 2f
 386 01ba 8C91      	1:	lsl r24
 387 01bc 482F      		rol r25
 388 01be 8091 0000 	2:	dec r18
 389 01c2 882F      		brpl 1b
 390 01c4 90E0      		or r24,r20
 391 01c6 FC01      		st X,r24
 393 01ca F040      	.LM10:
 394 01cc 8081      		ldi r26,lo8(88)
 395 01ce 282F      		ldi r27,hi8(88)
 396 01d0 30E0      		ldi r30,lo8(88)
 397 01d2 81E0      		ldi r31,hi8(88)
 398 01d4 90E0      		ld r24,Z
 399 01d6 00C0      		andi r24,lo8(-2)
 400 01d8 880F      		st X,r24
 402 01dc 2A95      	.LM11:
 403 01de 02F4      		ldi r26,lo8(82)
 404 01e0 842B      		ldi r27,hi8(82)
 405 01e2 8C93      		lds r24,gServoIndex
 132:biobot.c      **** 	
 133:biobot.c      ****         TIFR &= ~_BV(TOV0);
 406               	vw r24,r18
 407               		lsl r24
 408 01e4 A8E5      		rol r25
 409 01e6 B0E0      		add r24,r18
 410 01e8 E8E5      		adc r25,r19
 411 01ea F0E0      		movw r18,r24
 412 01ec 8081      		lsl r18
 413 01ee 8E7F      		rol r19
 414 01f0 8C93      		lsl r18
 134:biobot.c      ****         TCNT0 = 0xFF - (gServos[gServoIndex].pulse_slot_header & 0xFF); // must be first
 415               		add r24,r18
 416               		adc r25,r19
 417 01f2 A2E5      		movw r30,r24
 418 01f4 B0E0      		subi r30,lo8(-(gServos+12))
 419 01f6 8091 0000 		sbci r31,hi8(-(gServos+12))
 420 01fa 282F      		ld r24,Z
 421 01fc 30E0      		ldd r25,Z+1
 422 01fe C901      		com r24
 423 0200 880F      		st X,r24
 425 0204 820F      	.LM12:
 426 0206 931F      		ldi r26,lo8(89)
 427 0208 9C01      		ldi r27,hi8(89)
 428 020a 220F      		ldi r30,lo8(89)
 429 020c 331F      		ldi r31,hi8(89)
 430 020e 220F      		ld r24,Z
 431 0210 331F      		ori r24,lo8(1)
 432 0212 820F      		st X,r24
 434 0216 FC01      	.LM13:
 435 0218 E050      		ldi r26,lo8(50)
 436 021a F040      		ldi r27,hi8(50)
 437 021c 8081      		ldi r30,lo8(50)
 438 021e 9181      		ldi r31,hi8(50)
 439 0220 8095      		ld r24,Z
 440 0222 8C93      		andi r24,lo8(-3)
 135:biobot.c      ****         TIMSK |= _BV(TOIE0);
 442               	.LM14:
 443 0224 A9E5      		lds r24,gActiveServoIndex1
 444 0226 B0E0      		cpi r24,lo8(-1)
 445 0228 E9E5      		breq .+2
 446 022a F0E0      		rjmp .L4
 448 022e 8160      	.LM15:
 449 0230 8C93      		lds r24,gServoIndex
 136:biobot.c      **** 		
 137:biobot.c      **** 		DEBUG_PULSE_LOW_1();
 450               	iveServoIndex1,r24
 452 0232 A2E3      	.LM16:
 453 0234 B0E0      		lds r24,gServoIndex
 454 0236 E2E3      		mov r16,r24
 455 0238 F0E0      		ldi r17,lo8(0)
 456 023a 8081      		lds r24,gServoIndex
 457 023c 8D7F      		mov r18,r24
 458 023e 8C93      		ldi r19,lo8(0)
 459 0240 00C0      		movw r24,r18
 460               		lsl r24
 138:biobot.c      ****     }
 139:biobot.c      ****     else if( gActiveServoIndex1 == -1 )
 461               	dd r24,r18
 462               		adc r25,r19
 463 0242 8091 0000 		movw r18,r24
 464 0246 8F3F      		lsl r18
 465 0248 01F0      		rol r19
 466 024a 00C0      		lsl r18
 140:biobot.c      ****     {	
 141:biobot.c      ****         gActiveServoIndex1 = gServoIndex;       		
 467               	19
 468               		add r24,r18
 469 024c 8091 0000 		adc r25,r19
 470 0250 8093 0000 		movw r30,r24
 142:biobot.c      ****         gServos[gServoIndex].pulse_slot_header = gServos[gServoIndex].current_pulse % PULSE_SLOT_TI
 471               	i r30,lo8(-(gServos+6))
 472               		sbci r31,hi8(-(gServos+6))
 473 0254 8091 0000 		ld r24,Z
 474 0258 082F      		ldd r25,Z+1
 475 025a 10E0      		ldi r18,lo8(100)
 476 025c 8091 0000 		ldi r19,hi8(100)
 477 0260 282F      		movw r22,r18
 478 0262 30E0      		rcall __udivmodhi4
 479 0264 C901      		movw r20,r24
 480 0266 880F      		subi r20,lo8(-(100))
 481 0268 991F      		sbci r21,hi8(-(100))
 482 026a 820F      		movw r24,r16
 483 026c 931F      		lsl r24
 484 026e 9C01      		rol r25
 485 0270 220F      		add r24,r16
 486 0272 331F      		adc r25,r17
 487 0274 220F      		movw r18,r24
 488 0276 331F      		lsl r18
 489 0278 820F      		rol r19
 490 027a 931F      		lsl r18
 491 027c FC01      		rol r19
 492 027e E050      		add r24,r18
 493 0280 F040      		adc r25,r19
 494 0282 8081      		movw r30,r24
 495 0284 9181      		subi r30,lo8(-(gServos+12))
 496 0286 24E6      		sbci r31,hi8(-(gServos+12))
 497 0288 30E0      		std Z+1,r21
 498 028a B901      		st Z,r20
 500 028e AC01      	.LM17:
 501 0290 4C59      		lds r24,gServoIndex
 502 0292 5F4F      		mov r16,r24
 503 0294 C801      		ldi r17,lo8(0)
 504 0296 880F      		lds r24,gServoIndex
 505 0298 991F      		mov r18,r24
 506 029a 800F      		ldi r19,lo8(0)
 507 029c 911F      		movw r24,r18
 508 029e 9C01      		lsl r24
 509 02a0 220F      		rol r25
 510 02a2 331F      		add r24,r18
 511 02a4 220F      		adc r25,r19
 512 02a6 331F      		movw r18,r24
 513 02a8 820F      		lsl r18
 514 02aa 931F      		rol r19
 515 02ac FC01      		lsl r18
 516 02ae E050      		rol r19
 517 02b0 F040      		add r24,r18
 518 02b2 5183      		adc r25,r19
 519 02b4 4083      		movw r30,r24
 143:biobot.c      ****         gServos[gServoIndex].pulse_slot_count = gServos[gServoIndex].current_pulse / PULSE_SLOT_TIM
 520               	os+6))
 521               		ld r24,Z
 522 02b6 8091 0000 		ldd r25,Z+1
 523 02ba 082F      		ldi r18,lo8(100)
 524 02bc 10E0      		ldi r19,hi8(100)
 525 02be 8091 0000 		movw r22,r18
 526 02c2 282F      		rcall __udivmodhi4
 527 02c4 30E0      		movw r24,r22
 528 02c6 C901      		movw r20,r24
 529 02c8 880F      		subi r20,lo8(-(-1))
 530 02ca 991F      		sbci r21,hi8(-(-1))
 531 02cc 820F      		movw r24,r16
 532 02ce 931F      		lsl r24
 533 02d0 9C01      		rol r25
 534 02d2 220F      		add r24,r16
 535 02d4 331F      		adc r25,r17
 536 02d6 220F      		movw r18,r24
 537 02d8 331F      		lsl r18
 538 02da 820F      		rol r19
 539 02dc 931F      		lsl r18
 540 02de FC01      		rol r19
 541 02e0 E050      		add r24,r18
 542 02e2 F040      		adc r25,r19
 543 02e4 8081      		movw r30,r24
 544 02e6 9181      		subi r30,lo8(-(gServos+10))
 545 02e8 24E6      		sbci r31,hi8(-(gServos+10))
 546 02ea 30E0      		std Z+1,r21
 547 02ec B901      		st Z,r20
 549 02f0 CB01      	.LM18:
 550 02f2 AC01      		lds r24,gServoIndex
 551 02f4 4150      		mov r24,r24
 552 02f6 5040      		ldi r25,lo8(0)
 553 02f8 C801      		lsl r24
 554 02fa 880F      		rol r25
 555 02fc 991F      		movw r30,r24
 556 02fe 800F      		subi r30,lo8(-(gServoPorts))
 557 0300 911F      		sbci r31,hi8(-(gServoPorts))
 558 0302 9C01      		ld r26,Z
 559 0304 220F      		ldd r27,Z+1
 560 0306 331F      		ld r24,X
 561 0308 220F      		mov r20,r24
 562 030a 331F      		lds r24,gServoIndex
 563 030c 820F      		mov r24,r24
 564 030e 931F      		ldi r25,lo8(0)
 565 0310 FC01      		movw r30,r24
 566 0312 E050      		subi r30,lo8(-(gServoPins))
 567 0314 F040      		sbci r31,hi8(-(gServoPins))
 568 0316 5183      		ld r24,Z
 569 0318 4083      		mov r18,r24
 144:biobot.c      **** 
 145:biobot.c      ****         // set high pulse
 146:biobot.c      ****         *(gServoPorts[gServoIndex]) |= _BV(gServoPins[gServoIndex]);
 570               	jmp 2f
 571               	1:	lsl r24
 572 031a 8091 0000 		rol r25
 573 031e 882F      	2:	dec r18
 574 0320 90E0      		brpl 1b
 575 0322 880F      		or r24,r20
 576 0324 991F      		st X,r24
 578 0328 E050      	.LM19:
 579 032a F040      		ldi r26,lo8(88)
 580 032c A081      		ldi r27,hi8(88)
 581 032e B181      		ldi r30,lo8(88)
 582 0330 8C91      		ldi r31,hi8(88)
 583 0332 482F      		ld r24,Z
 584 0334 8091 0000 		andi r24,lo8(-65)
 585 0338 882F      		st X,r24
 587 033c FC01      	.LM20:
 588 033e E050      		ldi r26,lo8(68)
 589 0340 F040      		ldi r27,hi8(68)
 590 0342 8081      		lds r24,gServoIndex
 591 0344 282F      		mov r18,r24
 592 0346 30E0      		ldi r19,lo8(0)
 593 0348 81E0      		movw r24,r18
 594 034a 90E0      		lsl r24
 595 034c 00C0      		rol r25
 596 034e 880F      		add r24,r18
 597 0350 991F      		adc r25,r19
 598 0352 2A95      		movw r18,r24
 599 0354 02F4      		lsl r18
 600 0356 842B      		rol r19
 601 0358 8C93      		lsl r18
 147:biobot.c      **** 	
 148:biobot.c      ****         TIFR &= ~_BV(TOV2);
 602               	19
 603               		movw r30,r24
 604 035a A8E5      		subi r30,lo8(-(gServos+12))
 605 035c B0E0      		sbci r31,hi8(-(gServos+12))
 606 035e E8E5      		ld r24,Z
 607 0360 F0E0      		ldd r25,Z+1
 608 0362 8081      		com r24
 609 0364 8F7B      		st X,r24
 149:biobot.c      ****         TCNT2 = 0xFF - (gServos[gServoIndex].pulse_slot_header & 0xFF); // must be first
 611               	di r26,lo8(89)
 612               		ldi r27,hi8(89)
 613 0368 A4E4      		ldi r30,lo8(89)
 614 036a B0E0      		ldi r31,hi8(89)
 615 036c 8091 0000 		ld r24,Z
 616 0370 282F      		ori r24,lo8(64)
 617 0372 30E0      		st X,r24
 618 0374 C901      		rjmp .L2
 619 0376 880F      	.L4:
 621 037a 820F      	.LM22:
 622 037c 931F      		ldi r30,lo8(89)
 623 037e 9C01      		ldi r31,hi8(89)
 624 0380 220F      		st Z,__zero_reg__
 625 0382 331F      	.L2:
 627 0386 331F      	.LM23:
 628 0388 820F      		lds r24,gServoIndex
 629 038a 931F      		subi r24,lo8(-(1))
 630 038c FC01      		sts gServoIndex,r24
 632 0390 F040      	.LM24:
 633 0392 8081      		lds r24,gServoIndex
 634 0394 9181      		cpi r24,lo8(16)
 635 0396 8095      		brlo .L5
 636 0398 8C93      		sts gServoIndex,__zero_reg__
 150:biobot.c      ****         TIMSK |= _BV(TOIE2);                                                                       
 637               	5-.LFBB1
 638               	.LM25:
 639 039a A9E5      		ldi r30,lo8(76)
 640 039c B0E0      		ldi r31,hi8(76)
 641 039e E9E5      		ldi r24,lo8(-1151)
 642 03a0 F0E0      		ldi r25,hi8(-1151)
 643 03a2 8081      		std Z+1,r25
 644 03a4 8064      		st Z,r24
 646 03a8 00C0      	.LM26:
 647               		ldi r26,lo8(50)
 151:biobot.c      ****     }
 152:biobot.c      ****     else{
 153:biobot.c      ****         TIMSK = 0;
 648               	8(50)
 649               		ldi r30,lo8(50)
 650 03aa E9E5      		ldi r31,hi8(50)
 651 03ac F0E0      		ld r24,Z
 652 03ae 1082      		andi r24,lo8(-2)
 653               		st X,r24
 154:biobot.c      ****     }		
 155:biobot.c      **** 
 156:biobot.c      **** inc_index:		
 157:biobot.c      **** 	gServoIndex++;
 654               	logue start */
 656 03b0 8091 0000 	.LM27:
 657 03b4 8F5F      		pop r28
 658 03b6 8093 0000 		pop r29
 158:biobot.c      **** 	if( gServoIndex >= PIN_COUNT )  gServoIndex = PIN0;    	
 659               	r31
 660               		pop r30
 661 03ba 8091 0000 		pop r27
 662 03be 8031      		pop r26
 663 03c0 00F0      		pop r25
 664 03c2 1092 0000 		pop r24
 665               		pop r23
 159:biobot.c      **** 
 160:biobot.c      **** // reload counter
 161:biobot.c      ****     TCNT1 = MAIN_SLOT_RELOAD_COUNTER;
 666               	2
 667               		pop r21
 668 03c6 ECE4      		pop r20
 669 03c8 F0E0      		pop r19
 670 03ca 81E8      		pop r18
 671 03cc 9BEF      		pop r17
 672 03ce 9183      		pop r16
 673 03d0 8083      		pop r0
 162:biobot.c      **** 
 163:biobot.c      ****     DEBUG_PULSE_LOW();      	
 674               	REG__,r0
 675               		pop r0
 676 03d2 A2E3      		pop __zero_reg__
 677 03d4 B0E0      		reti
 679 03d8 F0E0      	.Lscope1:
 681 03dc 8E7F      	.global	__vector_9
 683               	__vector_9:
 164:biobot.c      **** }
 684               	,0,172,.LM28-.LFBB2
 685               	.LM28:
 686 03e0 CF91      	.LFBB2:
 687 03e2 DF91      		push __zero_reg__
 688 03e4 FF91      		push r0
 689 03e6 EF91      		in r0,__SREG__
 690 03e8 BF91      		push r0
 691 03ea AF91      		clr __zero_reg__
 692 03ec 9F91      		push r18
 693 03ee 8F91      		push r19
 694 03f0 7F91      		push r20
 695 03f2 6F91      		push r21
 696 03f4 5F91      		push r22
 697 03f6 4F91      		push r23
 698 03f8 3F91      		push r24
 699 03fa 2F91      		push r25
 700 03fc 1F91      		push r26
 701 03fe 0F91      		push r27
 702 0400 0F90      		push r30
 703 0402 0FBE      		push r31
 704 0404 0F90      		push r29
 705 0406 1F90      		push r28
 706 0408 1895      		in r28,__SP_L__
 707               		in r29,__SP_H__
 708               	/* prologue: Signal */
 709               	/* frame size = 0 */
 711               	.LM29:
 712               		ldi r26,lo8(50)
 165:biobot.c      **** 
 166:biobot.c      **** 
 167:biobot.c      **** /**
 168:biobot.c      ****  * TIMER0(8bit)
 169:biobot.c      ****  * T slot time=100us
 170:biobot.c      ****  */
 171:biobot.c      **** ISR( TIMER0_OVF_vect )
 172:biobot.c      **** {
 713               	(50)
 714               		ldi r31,hi8(50)
 715               		ld r24,Z
 716 040a 1F92      		ori r24,lo8(2)
 717 040c 0F92      		st X,r24
 719 0410 0F92      	.LM30:
 720 0412 1124      		ldi r26,lo8(50)
 721 0414 2F93      		ldi r27,hi8(50)
 722 0416 3F93      		ldi r30,lo8(50)
 723 0418 4F93      		ldi r31,hi8(50)
 724 041a 5F93      		ld r24,Z
 725 041c 6F93      		andi r24,lo8(-3)
 726 041e 7F93      		st X,r24
 728 0422 9F93      	.LM31:
 729 0424 AF93      		ldi r26,lo8(89)
 730 0426 BF93      		ldi r27,hi8(89)
 731 0428 EF93      		ldi r30,lo8(89)
 732 042a FF93      		ldi r31,hi8(89)
 733 042c DF93      		ld r24,Z
 734 042e CF93      		andi r24,lo8(-2)
 735 0430 CDB7      		st X,r24
 737               	.LM32:
 738               		ldi r26,lo8(88)
 173:biobot.c      **** 	DEBUG_PULSE_HIGH_1();
 739               	lo8(88)
 740               		ldi r31,hi8(88)
 741 0434 A2E3      		ld r24,Z
 742 0436 B0E0      		andi r24,lo8(-2)
 743 0438 E2E3      		st X,r24
 745 043c 8081      	.LM33:
 746 043e 8260      		lds r24,gActiveServoIndex0
 747 0440 8C93      		mov r18,r24
 174:biobot.c      **** 	DEBUG_PULSE_LOW_1();
 748               		sbrc r18,7
 749               		com r19
 750 0442 A2E3      		movw r24,r18
 751 0444 B0E0      		lsl r24
 752 0446 E2E3      		rol r25
 753 0448 F0E0      		add r24,r18
 754 044a 8081      		adc r25,r19
 755 044c 8D7F      		movw r18,r24
 756 044e 8C93      		lsl r18
 175:biobot.c      **** 	
 176:biobot.c      **** 	TIMSK &= ~_BV(TOIE0);	
 757               		lsl r18
 758               		rol r19
 759 0450 A9E5      		add r24,r18
 760 0452 B0E0      		adc r25,r19
 761 0454 E9E5      		movw r30,r24
 762 0456 F0E0      		subi r30,lo8(-(gServos+10))
 763 0458 8081      		sbci r31,hi8(-(gServos+10))
 764 045a 8E7F      		ld r24,Z
 765 045c 8C93      		ldd r25,Z+1
 177:biobot.c      ****     TIFR &= ~_BV(TOV0);			
 766               	,0
 767               		brne .L8
 769 0460 B0E0      	.LM34:
 770 0462 E8E5      		lds r24,gActiveServoIndex0
 771 0464 F0E0      		clr r25
 772 0466 8081      		sbrc r24,7
 773 0468 8E7F      		com r25
 774 046a 8C93      		lsl r24
 178:biobot.c      **** 	
 179:biobot.c      **** 	if( gServos[gActiveServoIndex0].pulse_slot_count == 0 ){
 775               		movw r30,r24
 776               		subi r30,lo8(-(gServoPorts))
 777 046c 8091 0000 		sbci r31,hi8(-(gServoPorts))
 778 0470 282F      		ld r26,Z
 779 0472 3327      		ldd r27,Z+1
 780 0474 27FD      		ld r24,X
 781 0476 3095      		mov r20,r24
 782 0478 C901      		lds r24,gActiveServoIndex0
 783 047a 880F      		clr r25
 784 047c 991F      		sbrc r24,7
 785 047e 820F      		com r25
 786 0480 931F      		movw r30,r24
 787 0482 9C01      		subi r30,lo8(-(gServoPins))
 788 0484 220F      		sbci r31,hi8(-(gServoPins))
 789 0486 331F      		ld r24,Z
 790 0488 220F      		mov r18,r24
 791 048a 331F      		ldi r19,lo8(0)
 792 048c 820F      		ldi r24,lo8(1)
 793 048e 931F      		ldi r25,hi8(1)
 794 0490 FC01      		mov r0,r18
 795 0492 E050      		rjmp 2f
 796 0494 F040      	1:	lsl r24
 797 0496 8081      		rol r25
 798 0498 9181      	2:	dec r0
 799 049a 0097      		brpl 1b
 800 049c 01F4      		com r24
 180:biobot.c      ****         // set low pulse
 181:biobot.c      **** 	    *(gServoPorts[gActiveServoIndex0]) &= ~_BV(gServoPins[gActiveServoIndex0]);	
 801               	tabn	68,0,182,.LM35-.LFBB2
 802               	.LM35:
 803 049e 8091 0000 		ldi r24,lo8(-1)
 804 04a2 9927      		sts gActiveServoIndex0,r24
 806 04a6 9095      	.LM36:
 807 04a8 880F      		ldi r26,lo8(50)
 808 04aa 991F      		ldi r27,hi8(50)
 809 04ac FC01      		ldi r30,lo8(50)
 810 04ae E050      		ldi r31,hi8(50)
 811 04b0 F040      		ld r24,Z
 812 04b2 A081      		ori r24,lo8(2)
 813 04b4 B181      		st X,r24
 815 04b8 482F      	.LM37:
 816 04ba 8091 0000 		ldi r26,lo8(50)
 817 04be 9927      		ldi r27,hi8(50)
 818 04c0 87FD      		ldi r30,lo8(50)
 819 04c2 9095      		ldi r31,hi8(50)
 820 04c4 FC01      		ld r24,Z
 821 04c6 E050      		andi r24,lo8(-3)
 822 04c8 F040      		st X,r24
 823 04ca 8081      		rjmp .L10
 824 04cc 282F      	.L8:
 826 04d0 81E0      	.LM38:
 827 04d2 90E0      		ldi r30,lo8(82)
 828 04d4 022E      		ldi r31,hi8(82)
 829 04d6 00C0      		ldi r24,lo8(-128)
 830 04d8 880F      		st Z,r24
 832 04dc 0A94      	.LM39:
 833 04de 02F4      		ldi r26,lo8(89)
 834 04e0 8095      		ldi r27,hi8(89)
 835 04e2 8423      		ldi r30,lo8(89)
 836 04e4 8C93      		ldi r31,hi8(89)
 182:biobot.c      ****         gActiveServoIndex0 = -1; // timer 1 idle status	  
 838               	.LM40:
 839 04e6 8FEF      		lds r24,gActiveServoIndex0
 840 04e8 8093 0000 		mov r20,r24
 183:biobot.c      **** 		DEBUG_PULSE_HIGH_1();      	
 841               	 r21
 842               		sbrc r20,7
 843 04ec A2E3      		com r21
 844 04ee B0E0      		movw r24,r20
 845 04f0 E2E3      		lsl r24
 846 04f2 F0E0      		rol r25
 847 04f4 8081      		add r24,r20
 848 04f6 8260      		adc r25,r21
 849 04f8 8C93      		movw r18,r24
 184:biobot.c      **** 		DEBUG_PULSE_LOW_1();
 850               		rol r19
 851               		lsl r18
 852 04fa A2E3      		rol r19
 853 04fc B0E0      		add r24,r18
 854 04fe E2E3      		adc r25,r19
 855 0500 F0E0      		movw r30,r24
 856 0502 8081      		subi r30,lo8(-(gServos+10))
 857 0504 8D7F      		sbci r31,hi8(-(gServos+10))
 858 0506 8C93      		ld r24,Z
 859 0508 00C0      		ldd r25,Z+1
 860               		movw r22,r24
 185:biobot.c      **** 	}
 186:biobot.c      **** 	else{
 187:biobot.c      ****         TCNT0 = PULSE_SLOT_RELOAD_COUNT; // must be first
 861               	o8(-(-1))
 862               		sbci r23,hi8(-(-1))
 863 050a E2E5      		movw r24,r20
 864 050c F0E0      		lsl r24
 865 050e 80E8      		rol r25
 866 0510 8083      		add r24,r20
 188:biobot.c      ****         TIMSK |= _BV(TOIE0);
 867               	25,r21
 868               		movw r18,r24
 869 0512 A9E5      		lsl r18
 870 0514 B0E0      		rol r19
 871 0516 E9E5      		lsl r18
 872 0518 F0E0      		rol r19
 873 051a 8081      		add r24,r18
 874 051c 8160      		adc r25,r19
 875 051e 8C93      		movw r30,r24
 189:biobot.c      ****         gServos[gActiveServoIndex0].pulse_slot_count --;		
 876               	,lo8(-(gServos+10))
 877               		sbci r31,hi8(-(gServos+10))
 878 0520 8091 0000 		std Z+1,r23
 879 0524 482F      		st Z,r22
 880 0526 5527      	.L10:
 881 0528 47FD      	/* epilogue start */
 883 052c CA01      	.LM41:
 884 052e 880F      		pop r28
 885 0530 991F      		pop r29
 886 0532 840F      		pop r31
 887 0534 951F      		pop r30
 888 0536 9C01      		pop r27
 889 0538 220F      		pop r26
 890 053a 331F      		pop r25
 891 053c 220F      		pop r24
 892 053e 331F      		pop r23
 893 0540 820F      		pop r22
 894 0542 931F      		pop r21
 895 0544 FC01      		pop r20
 896 0546 E050      		pop r19
 897 0548 F040      		pop r18
 898 054a 8081      		pop r0
 899 054c 9181      		out __SREG__,r0
 900 054e BC01      		pop r0
 901 0550 6150      		pop __zero_reg__
 902 0552 7040      		reti
 904 0556 880F      	.Lscope2:
 906 055a 840F      	.global	__vector_4
 908 055e 9C01      	__vector_4:
 910 0562 331F      	.LM42:
 911 0564 220F      	.LFBB3:
 912 0566 331F      		push __zero_reg__
 913 0568 820F      		push r0
 914 056a 931F      		in r0,__SREG__
 915 056c FC01      		push r0
 916 056e E050      		clr __zero_reg__
 917 0570 F040      		push r18
 918 0572 7183      		push r19
 919 0574 6083      		push r20
 920               		push r21
 921               		push r22
 190:biobot.c      **** 	}		
 191:biobot.c      **** }
 922               	r27
 923               		push r30
 924 0576 CF91      		push r31
 925 0578 DF91      		push r29
 926 057a FF91      		push r28
 927 057c EF91      		in r28,__SP_L__
 928 057e BF91      		in r29,__SP_H__
 929 0580 AF91      	/* prologue: Signal */
 930 0582 9F91      	/* frame size = 0 */
 932 0586 7F91      	.LM43:
 933 0588 6F91      		ldi r26,lo8(89)
 934 058a 5F91      		ldi r27,hi8(89)
 935 058c 4F91      		ldi r30,lo8(89)
 936 058e 3F91      		ldi r31,hi8(89)
 937 0590 2F91      		ld r24,Z
 938 0592 0F90      		andi r24,lo8(-65)
 939 0594 0FBE      		st X,r24
 941 0598 1F90      	.LM44:
 942 059a 1895      		ldi r26,lo8(88)
 943               		ldi r27,hi8(88)
 944               		ldi r30,lo8(88)
 945               		ldi r31,hi8(88)
 946               		ld r24,Z
 947               		andi r24,lo8(-65)
 948               		st X,r24
 192:biobot.c      **** 
 193:biobot.c      **** /**
 194:biobot.c      ****  * TIMER2(8bit)
 195:biobot.c      ****  * T slot time=100us
 196:biobot.c      ****  */
 197:biobot.c      **** ISR( TIMER2_OVF_vect )
 198:biobot.c      **** {
 949               	B3
 950               	.LM45:
 951               		lds r24,gActiveServoIndex1
 952 059c 1F92      		mov r18,r24
 953 059e 0F92      		clr r19
 954 05a0 0FB6      		sbrc r18,7
 955 05a2 0F92      		com r19
 956 05a4 1124      		movw r24,r18
 957 05a6 2F93      		lsl r24
 958 05a8 3F93      		rol r25
 959 05aa 4F93      		add r24,r18
 960 05ac 5F93      		adc r25,r19
 961 05ae 6F93      		movw r18,r24
 962 05b0 7F93      		lsl r18
 963 05b2 8F93      		rol r19
 964 05b4 9F93      		lsl r18
 965 05b6 AF93      		rol r19
 966 05b8 BF93      		add r24,r18
 967 05ba EF93      		adc r25,r19
 968 05bc FF93      		movw r30,r24
 969 05be DF93      		subi r30,lo8(-(gServos+10))
 970 05c0 CF93      		sbci r31,hi8(-(gServos+10))
 971 05c2 CDB7      		ld r24,Z
 972 05c4 DEB7      		ldd r25,Z+1
 973               		sbiw r24,0
 974               		brne .L12
 199:biobot.c      ****     //DEBUG_PULSE_HIGH();
 200:biobot.c      **** 
 201:biobot.c      **** 	TIMSK &= ~_BV(TOIE2);		
 975               	BB3
 976               	.LM46:
 977 05c6 A9E5      		lds r24,gActiveServoIndex1
 978 05c8 B0E0      		clr r25
 979 05ca E9E5      		sbrc r24,7
 980 05cc F0E0      		com r25
 981 05ce 8081      		lsl r24
 982 05d0 8F7B      		rol r25
 983 05d2 8C93      		movw r30,r24
 202:biobot.c      **** 	TIFR &= ~_BV(TOV2);
 984               	,lo8(-(gServoPorts))
 985               		sbci r31,hi8(-(gServoPorts))
 986 05d4 A8E5      		ld r26,Z
 987 05d6 B0E0      		ldd r27,Z+1
 988 05d8 E8E5      		ld r24,X
 989 05da F0E0      		mov r20,r24
 990 05dc 8081      		lds r24,gActiveServoIndex1
 991 05de 8F7B      		clr r25
 992 05e0 8C93      		sbrc r24,7
 203:biobot.c      **** 	
 204:biobot.c      **** 	if( gServos[gActiveServoIndex1].pulse_slot_count == 0 ){
 993               		movw r30,r24
 994               		subi r30,lo8(-(gServoPins))
 995 05e2 8091 0000 		sbci r31,hi8(-(gServoPins))
 996 05e6 282F      		ld r24,Z
 997 05e8 3327      		mov r18,r24
 998 05ea 27FD      		ldi r19,lo8(0)
 999 05ec 3095      		ldi r24,lo8(1)
 1000 05ee C901      		ldi r25,hi8(1)
 1001 05f0 880F      		mov r0,r18
 1002 05f2 991F      		rjmp 2f
 1003 05f4 820F      	1:	lsl r24
 1004 05f6 931F      		rol r25
 1005 05f8 9C01      	2:	dec r0
 1006 05fa 220F      		brpl 1b
 1007 05fc 331F      		com r24
 1008 05fe 220F      		and r24,r20
 1009 0600 331F      		st X,r24
 1011 0604 931F      	.LM47:
 1012 0606 FC01      		ldi r24,lo8(-1)
 1013 0608 E050      		sts gActiveServoIndex1,r24
 1014 060a F040      		rjmp .L14
 1015 060c 8081      	.L12:
 1017 0610 0097      	.LM48:
 1018 0612 01F4      		ldi r30,lo8(68)
 205:biobot.c      ****         // set low pulse
 206:biobot.c      **** 	    *(gServoPorts[gActiveServoIndex1]) &= ~_BV(gServoPins[gActiveServoIndex1]);	
 1019               	lo8(-128)
 1020               		st Z,r24
 1022 0618 9927      	.LM49:
 1023 061a 87FD      		ldi r26,lo8(89)
 1024 061c 9095      		ldi r27,hi8(89)
 1025 061e 880F      		ldi r30,lo8(89)
 1026 0620 991F      		ldi r31,hi8(89)
 1027 0622 FC01      		ld r24,Z
 1028 0624 E050      		ori r24,lo8(64)
 1029 0626 F040      		st X,r24
 1031 062a B181      	.LM50:
 1032 062c 8C91      		lds r24,gActiveServoIndex1
 1033 062e 482F      		mov r20,r24
 1034 0630 8091 0000 		clr r21
 1035 0634 9927      		sbrc r20,7
 1036 0636 87FD      		com r21
 1037 0638 9095      		movw r24,r20
 1038 063a FC01      		lsl r24
 1039 063c E050      		rol r25
 1040 063e F040      		add r24,r20
 1041 0640 8081      		adc r25,r21
 1042 0642 282F      		movw r18,r24
 1043 0644 30E0      		lsl r18
 1044 0646 81E0      		rol r19
 1045 0648 90E0      		lsl r18
 1046 064a 022E      		rol r19
 1047 064c 00C0      		add r24,r18
 1048 064e 880F      		adc r25,r19
 1049 0650 991F      		movw r30,r24
 1050 0652 0A94      		subi r30,lo8(-(gServos+10))
 1051 0654 02F4      		sbci r31,hi8(-(gServos+10))
 1052 0656 8095      		ld r24,Z
 1053 0658 8423      		ldd r25,Z+1
 1054 065a 8C93      		movw r22,r24
 207:biobot.c      ****         gActiveServoIndex1 = -1; // timer 2 idle status		
 1055               	(-1))
 1056               		movw r24,r20
 1057 065c 8FEF      		lsl r24
 1058 065e 8093 0000 		rol r25
 1059 0662 00C0      		add r24,r20
 1060               		adc r25,r21
 208:biobot.c      **** 
 209:biobot.c      ****         //DEBUG_PULSE_LOW();	
 210:biobot.c      **** 	}
 211:biobot.c      **** 	else{
 212:biobot.c      ****         TCNT2 = PULSE_SLOT_RELOAD_COUNT; // must be first
 1061               	r18
 1062               		adc r25,r19
 1063 0664 E4E4      		movw r30,r24
 1064 0666 F0E0      		subi r30,lo8(-(gServos+10))
 1065 0668 80E8      		sbci r31,hi8(-(gServos+10))
 1066 066a 8083      		ld r24,Z
 213:biobot.c      ****         TIMSK |= _BV(TOIE2);
 1067               	brc r20,7
 1068               		com r21
 1069 066c A9E5      		movw r24,r20
 1070 066e B0E0      		lsl r24
 1071 0670 E9E5      		rol r25
 1072 0672 F0E0      		add r24,r20
 1073 0674 8081      		adc r25,r21
 1074 0676 8064      		movw r18,r24
 1075 0678 8C93      		lsl r18
 214:biobot.c      ****         gServos[gActiveServoIndex1].pulse_slot_count --;		
 1076               	
 1077               		ldi r31,hi8(89)
 1078 067a 8091 0000 		ld r24,Z
 1079 067e 482F      		ori r24,lo8(64)
 1080 0680 5527      		st X,r24
 1082 0684 5095      	.LM50:
 1083 0686 CA01      		lds r24,gActiveServoIndex1
 1084 0688 880F      		mov r20,r24
 1085 068a 991F      		clr r21
 1086 068c 840F      		sbrc r20,7
 1087 068e 951F      		com r21
 1088 0690 9C01      		movw r24,r20
 1089 0692 220F      		lsl r24
 1090 0694 331F      		rol r25
 1091 0696 220F      		add r24,r20
 1092 0698 331F      		adc r25,r21
 1093 069a 820F      		movw r18,r24
 1094 069c 931F      		lsl r18
 1095 069e FC01      		rol r19
 1096 06a0 E050      		lsl r18
 1097 06a2 F040      		rol r19
 1098 06a4 8081      		add r24,r18
 1099 06a6 9181      		adc r25,r19
 1100 06a8 BC01      		movw r30,r24
 1101 06aa 6150      		subi r30,lo8(-(gServos+10))
 1102 06ac 7040      		sbci r31,hi8(-(gServos+10))
 1103 06ae CA01      		ld r24,Z
 1104 06b0 880F      		ldd r25,Z+1
 1105 06b2 991F      		movw r22,r24
 1106 06b4 840F      		subi r22,lo8(-(-1))
 1107 06b6 951F      		sbci r23,hi8(-(-1))
 1108 06b8 9C01      		movw r24,r20
 1109 06ba 220F      		lsl r24
 1110 06bc 331F      		rol r25
 1111 06be 220F      		add r24,r20
 1112 06c0 331F      		adc r25,r21
 1113 06c2 820F      		movw r18,r24
 1114 06c4 931F      		lsl r18
 1115 06c6 FC01      		rol r19
 1116 06c8 E050      		lsl r18
 1117 06ca F040      		rol r19
 1118 06cc 7183      		add r24,r18
 1119 06ce 6083      		adc r25,r19
 1120               		movw r30,r24
 1121               		subi r30,lo8(-(gServos+10))
 215:biobot.c      **** 	}       						
 216:biobot.c      **** }
 1122               	 Z,r22
 1123               	.L14:
 1124 06d0 CF91      	/* epilogue start */
 1126 06d4 FF91      	.LM51:
 1127 06d6 EF91      		pop r28
 1128 06d8 BF91      		pop r29
 1129 06da AF91      		pop r31
 1130 06dc 9F91      		pop r30
 1131 06de 8F91      		pop r27
 1132 06e0 7F91      		pop r26
 1133 06e2 6F91      		pop r25
 1134 06e4 5F91      		pop r24
 1135 06e6 4F91      		pop r23
 1136 06e8 3F91      		pop r22
 1137 06ea 2F91      		pop r21
 1138 06ec 0F90      		pop r20
 1139 06ee 0FBE      		pop r19
 1140 06f0 0F90      		pop r18
 1141 06f2 1F90      		pop r0
 1142 06f4 1895      		out __SREG__,r0
 1143               		pop r0
 1144               		pop __zero_reg__
 1145               		reti
 1147               	.Lscope3:
 217:biobot.c      **** 
 218:biobot.c      **** int main(void)
 219:biobot.c      **** {
 1149               	
 1150               		pop r23
 1151               		pop r22
 1152 06f6 DF93      		pop r21
 1153 06f8 CF93      		pop r20
 1154 06fa 00D0      		pop r19
 1155 06fc CDB7      		pop r18
 1156 06fe DEB7      		pop r0
 1157               		out __SREG__,r0
 1158               		pop r0
 220:biobot.c      ****     cli();	
 1159               	tabn	68,0,216,.LM51-.LFBB3
 1160               	.LM51:
 1161               		pop r28
 1162               		pop r29
 1163 0700 F894      		pop r31
 1164               		pop r30
 221:biobot.c      **** 	
 222:biobot.c      ****     // OUTPUT
 223:biobot.c      **** 
 224:biobot.c      ****     DDRC |= _BV(SERVO_PIN0) | _BV(SERVO_PIN1) | _BV(SERVO_PIN2) | _BV(SERVO_PIN3) | _BV(SERVO_PIN4)
 1165               	dc r25,r19
 1166               		movw r30,r24
 1167               		subi r30,lo8(-(gServos+10))
 1168 0702 A4E3      		sbci r31,hi8(-(gServos+10))
 1169 0704 B0E0      		std Z+1,r23
 1170 0706 E4E3      		st Z,r22
 1171 0708 F0E0      	.L14:
 1172 070a 8081      	/* epilogue start */
 1174 070e 8C93      	.LM51:
 225:biobot.c      ****     DDRD |= _BV(SERVO_PIN12) | _BV(SERVO_PIN13) | _BV(SERVO_PIN14) | _BV(SERVO_PIN15);
 1175               	ol r19
 1176               		lsl r18
 1177 0710 A1E3      		rol r19
 1178 0712 B0E0      		add r24,r18
 1179 0714 E1E3      		adc r25,r19
 1180 0716 F0E0      		movw r30,r24
 1181 0718 8081      		subi r30,lo8(-(gServos+10))
 1182 071a 806F      		sbci r31,hi8(-(gServos+10))
 1183 071c 8C93      		std Z+1,r23
 226:biobot.c      ****     DDRB |= _BV(SERVO_PIN6) | _BV(SERVO_PIN7) | _BV(SERVO_PIN8) | _BV(SERVO_PIN9) | _BV(SERVO_PIN10
 1184               	w r24,r20
 1185               		lsl r24
 1186 071e A7E3      		rol r25
 1187 0720 B0E0      		add r24,r20
 1188 0722 E7E3      		adc r25,r21
 1189 0724 F0E0      		movw r18,r24
 1190 0726 8081      		lsl r18
 1191 0728 8F63      		rol r19
 1192 072a 8C93      		lsl r18
 227:biobot.c      **** 
 228:biobot.c      ****     DDRD |= _BV(PD0);
 1193               	-(gServos+10))
 1194               		sbci r31,hi8(-(gServos+10))
 1195 072c A1E3      		ld r24,Z
 1196 072e B0E0      		ldd r25,Z+1
 1197 0730 E1E3      		movw r22,r24
 1198 0732 F0E0      		subi r22,lo8(-(-1))
 1199 0734 8081      		sbci r23,hi8(-(-1))
 1200 0736 8160      		movw r24,r20
 1201 0738 8C93      		lsl r24
 1202               		rol r25
 229:biobot.c      **** 
 230:biobot.c      ****     // 500 -> 532us
 231:biobot.c      ****     for( int i=0; i<PIN_COUNT; ++i ){
 1203               	
 1204               		lsl r18
 1205 073a 1A82      		rol r19
 1206 073c 1982      		add r24,r18
 1207 073e 00C0      		adc r25,r19
 1208               		movw r30,r24
 232:biobot.c      ****         gServos[i].enabled = 1;
 1209               	LM50-.LFBB3
 1210               	.LM50:
 1211 0740 2981      		lds r24,gActiveServoIndex1
 1212 0742 3A81      		mov r20,r24
 1213 0744 C901      		clr r21
 1214 0746 880F      		sbrc r20,7
 1215 0748 991F      		com r21
 1216 074a 820F      		movw r24,r20
 1217 074c 931F      		lsl r24
 1218 074e 9C01      		rol r25
 1219 0750 220F      		add r24,r20
 1220 0752 331F      		adc r25,r21
 1221 0754 220F      		movw r18,r24
 1222 0756 331F      		lsl r18
 1223 0758 820F      		rol r19
 1224 075a 931F      		lsl r18
 1225 075c FC01      		rol r19
 1226 075e E050      		add r24,r18
 1227 0760 F040      		adc r25,r19
 1228 0762 81E0      		movw r30,r24
 1229 0764 8083      		subi r30,lo8(-(gServos+10))
 233:biobot.c      ****         gServos[i].end_pulse = 500;
 1230               	os+10))
 1231               		ld r24,Z
 1232 0766 2981      		ldd r25,Z+1
 1233 0768 3A81      		movw r22,r24
 1234 076a C901      		subi r22,lo8(-(-1))
 1235 076c 880F      		sbci r23,hi8(-(-1))
 1236 076e 991F      		movw r24,r20
 1237 0770 820F      		lsl r24
 1238 0772 931F      		rol r25
 1239 0774 9C01      		add r24,r20
 1240 0776 220F      		adc r25,r21
 1241 0778 331F      		movw r18,r24
 1242 077a 220F      		lsl r18
 1243 077c 331F      		rol r19
 1244 077e 820F      		lsl r18
 1245 0780 931F      		rol r19
 1246 0782 FC01      		add r24,r18
 1247 0784 E050      		adc r25,r19
 1248 0786 F040      		movw r30,r24
 1249 0788 84EF      		subi r30,lo8(-(gServos+10))
 1250 078a 91E0      		sbci r31,hi8(-(gServos+10))
 1251 078c 9183      		std Z+1,r23
 1252 078e 8083      		st Z,r22
 1253               	.L14:
 1254               	/* epilogue start */
 1256 0792 9A81      	.LM51:
 1257 0794 0196      		pop r28
 1258 0796 9A83      		pop r29
 1259 0798 8983      		pop r31
 1260               		pop r30
 1261 079a 8981      		pop r27
 1262 079c 9A81      		pop r26
 1263 079e 8031      		pop r25
 1264 07a0 9105      		pop r24
 1265 07a2 04F0      		pop r23
 1266               		pop r22
 234:biobot.c      ****     }
 235:biobot.c      ****     	
 236:biobot.c      ****     // main clock T=250us
 237:biobot.c      ****     // TIMER0 clk_io/8
 238:biobot.c      ****     TCCR0 = _BV(CS01);
 1267               	r31,hi8(-(gServos+10))
 1268               		std Z+1,r23
 1269 07a4 E3E5      		st Z,r22
 1270 07a6 F0E0      	.L14:
 1271 07a8 82E0      	/* epilogue start */
 239:biobot.c      **** 
 240:biobot.c      ****     // long clock T>1500us
 241:biobot.c      ****     // TIMER1, clk_io/8
 242:biobot.c      ****     TCCR1B |= _BV(CS11);
 1273               	l r18
 1274               		rol r19
 1275 07ac AEE4      		lsl r18
 1276 07ae B0E0      		rol r19
 1277 07b0 EEE4      		add r24,r18
 1278 07b2 F0E0      		adc r25,r19
 1279 07b4 8081      		movw r30,r24
 1280 07b6 8260      		subi r30,lo8(-(gServos+10))
 1281 07b8 8C93      		sbci r31,hi8(-(gServos+10))
 243:biobot.c      ****     TIMSK |= _BV(TOIE1);
 1282               	i8(-(-1))
 1283               		movw r24,r20
 1284 07ba A9E5      		lsl r24
 1285 07bc B0E0      		rol r25
 1286 07be E9E5      		add r24,r20
 1287 07c0 F0E0      		adc r25,r21
 1288 07c2 8081      		movw r18,r24
 1289 07c4 8460      		lsl r18
 1290 07c6 8C93      		rol r19
 244:biobot.c      ****     TCNT1 = MAIN_SLOT_RELOAD_COUNTER;
 1291               	i r30,lo8(-(gServos+10))
 1292               		sbci r31,hi8(-(gServos+10))
 1293 07c8 ECE4      		ld r24,Z
 1294 07ca F0E0      		ldd r25,Z+1
 1295 07cc 81E8      		movw r22,r24
 1296 07ce 9BEF      		subi r22,lo8(-(-1))
 1297 07d0 9183      		sbci r23,hi8(-(-1))
 1298 07d2 8083      		movw r24,r20
 245:biobot.c      **** 	
 246:biobot.c      ****     // short clock T>=500us and T<=1500us
 247:biobot.c      ****     // TIMER2, clk_io/8
 248:biobot.c      ****     TCCR2 |= _BV(CS21);	
 1299               	24
 1300               		lsl r18
 1301 07d4 A5E4      		rol r19
 1302 07d6 B0E0      		lsl r18
 1303 07d8 E5E4      		rol r19
 1304 07da F0E0      		add r24,r18
 1305 07dc 8081      		adc r25,r19
 1306 07de 8260      		movw r30,r24
 1307 07e0 8C93      		subi r30,lo8(-(gServos+10))
 249:biobot.c      **** 		
 250:biobot.c      ****     sei();
 1308               	ctiveServoIndex1
 1309               		mov r20,r24
 1310               		clr r21
 1311               		sbrc r20,7
 1312 07e2 7894      		com r21
 1313               		movw r24,r20
 1314               		lsl r24
 1315               		rol r25
 1316 07e4 00C0      		add r24,r20
 1317               		adc r25,r21
 1318               		movw r18,r24
 1319               		lsl r18
 1320               		rol r19
 1321               		lsl r18
 1322               		rol r19
 1323               		add r24,r18
 1324               		adc r25,r19
 1325               		movw r30,r24
 1326               		subi r30,lo8(-(gServos+10))
 1327               		sbci r31,hi8(-(gServos+10))
 1328               		ld r24,Z
 1329               		ldd r25,Z+1
 1330               		movw r22,r24
 1331               		subi r22,lo8(-(-1))
 1332               		sbci r23,hi8(-(-1))
 1333               		movw r24,r20
DEFINED SYMBOLS
                            *ABS*:00000000 biobot.c
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:2      *ABS*:0000003f __SREG__
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:3      *ABS*:0000003e __SP_H__
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:4      *ABS*:0000003d __SP_L__
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:5      *ABS*:00000034 __CCP__
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:6      *ABS*:00000000 __tmp_reg__
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:7      *ABS*:00000001 __zero_reg__
                             .bss:00000002 gServoIndex
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:97     .data:00000000 gActiveServoIndex0
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:101    .data:00000001 gActiveServoIndex1
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:105    .data:00000002 gServoPins
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:124    .data:00000012 gServoPorts
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:146    .bss:00000000 gfile_shell
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:152    .text:00000000 __vector_8
                            *COM*:000000f0 gServos
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:712    .text:0000040a __vector_9
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:948    .text:0000059c __vector_4
C:\Users\win7\AppData\Local\Temp/ccX5UKqA.s:1148   .text:000006f6 main

UNDEFINED SYMBOLS
__udivmodhi4
__do_copy_data
__do_clear_bss
